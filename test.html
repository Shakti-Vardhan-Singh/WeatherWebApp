<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Weather ‚Äî Sleek & Simple</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg1: #0f1020;
      --bg2: #1a1b3a;
      --accent: #7c5cff;
      --accent-2: #22d3ee;
      --card: rgba(255,255,255,0.08);
      --card-2: rgba(255,255,255,0.06);
      --text: #e8e8f3;
      --muted: #b9bbd1;
      --success: #34d399;
      --danger: #fb7185;
      --warning: #f59e0b;
      --shadow: 0 10px 30px rgba(0,0,0,0.4);
    }

    * { box-sizing: border-box }
    html, body { height: 100% }
    body {
      margin: 0;
      font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      color: var(--text);
      background: radial-gradient(1200px 800px at 20% 0%, #181a3b 0%, #0e0f1c 40%, #0a0b16 100%),
                  linear-gradient(135deg, var(--bg1) 0%, var(--bg2) 100%);
      overflow-x: hidden;
    }

    /* Animated aurora background */
    .aurora {
      position: fixed; inset: -20% -20% auto -20%; height: 80vh; pointer-events: none; filter: blur(40px); opacity: .7;
      background: conic-gradient(from 140deg at 30% 40%, rgba(124,92,255,.25), rgba(34,211,238,.25), rgba(99,102,241,.25), rgba(34,211,238,.25));
      animation: drift 18s ease-in-out infinite alternate;
    }
    @keyframes drift { from { transform: translateY(-6%) rotate(0deg) } to { transform: translateY(6%) rotate(8deg) } }

    .container {
      max-width: 980px; margin: 0 auto; padding: 28px 18px 64px;
    }

    header {
      display:flex; align-items:center; justify-content:space-between; gap:16px; margin-top: 6vh; margin-bottom: 18px;
    }

    .brand {
      display:flex; align-items:center; gap:14px; user-select:none;
    }
    .logo {
      width: 44px; height: 44px; border-radius: 12px; background: linear-gradient(145deg, var(--accent), var(--accent-2));
      display:grid; place-items:center; box-shadow: var(--shadow);
    }
    .logo span { font-weight:800; font-size: 20px; color: white; letter-spacing: .5px }
    .title { font-weight: 800; font-size: clamp(20px, 3vw, 28px); letter-spacing: .2px }
    .subtitle { color: var(--muted); font-weight: 500; font-size: 12px; margin-top: 2px }

    .search {
      display:flex; gap:10px; width: min(520px, 100%);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border: 1px solid rgba(255,255,255,.12); padding: 8px; border-radius: 16px; box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }
    .search input {
      flex: 1; background: transparent; border: 0; outline: none; color: var(--text);
      font-size: 16px; padding: 12px 14px;
    }
    .search input::placeholder { color: #96a0b7 }
    .btn {
      border: 0; border-radius: 12px; padding: 12px 16px; cursor:pointer; font-weight:600; letter-spacing:.2px; color: #0b0c18;
      background: linear-gradient(160deg, var(--accent-2), var(--accent));
      transition: transform .12s ease, box-shadow .12s ease, filter .2s ease;
      box-shadow: 0 8px 22px rgba(124,92,255,.35);
    }
    .btn:hover { transform: translateY(-1px) }
    .btn:active { transform: translateY(0) scale(.98) }

    .grid {
      display: grid; grid-template-columns: 1.2fr .8fr; gap: 18px; align-items: stretch; margin-top: 16px;
    }

    .card {
      background: linear-gradient(180deg, var(--card), var(--card-2)); border: 1px solid rgba(255,255,255,.10);
      border-radius: 20px; padding: 18px; box-shadow: var(--shadow); backdrop-filter: blur(12px);
    }

    .current {
      display:grid; grid-template-columns: 1fr 1fr; gap: 8px 18px; align-items:center; min-height: 220px;
    }

    .temp { font-size: clamp(48px, 8vw, 74px); font-weight: 800; line-height: .95 }
    .temp small { font-size: .35em; font-weight: 700; color: var(--muted) }

    .place { font-weight: 700; font-size: 18px }
    .time { color: var(--muted); font-size: 14px }

    .conditions { display:flex; align-items:center; gap: 12px; margin-top: 8px }
    .conditions img { width: 64px; height: 64px }
    .badge {
      display:inline-flex; align-items:center; gap:8px; font-size: 12px; font-weight: 700; padding: 6px 10px; border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.08);
    }

    .row { display:flex; flex-wrap:wrap; gap:10px; margin-top: 10px }
    .chip { font-size: 12px; color: var(--muted); padding: 8px 10px; background: rgba(255,255,255,.06); border-radius: 10px; border: 1px solid rgba(255,255,255,.08) }

    .details { display:grid; grid-template-columns: repeat(2,1fr); gap: 12px; margin-top: 10px }
    .stat { background: rgba(255,255,255,.06); border: 1px solid rgba(255,255,255,.08); border-radius: 14px; padding: 12px }
    .stat .k { font-size: 12px; color: var(--muted) }
    .stat .v { font-weight: 700; margin-top: 4px; font-size: 16px }

    .aq {
      display:grid; grid-template-columns: 1fr 1fr; gap: 12px; align-items: start;
    }
    .aq .index { font-weight: 800; font-size: 42px }

    .footer { text-align:center; color: var(--muted); font-size: 12px; margin-top: 16px }

    .unit-toggle { display:inline-flex; gap:6px; background: rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.12); padding: 4px; border-radius: 999px }
    .unit-toggle button { background: transparent; border:0; color: var(--muted); font-weight:700; padding: 6px 10px; border-radius: 999px; cursor:pointer }
    .unit-toggle button.active { color: #0b0c18; background: linear-gradient(140deg, var(--accent-2), var(--accent)) }

    .ghost { opacity: .35 }
    .hidden { display:none }

    /* Shimmer for loading */
    .shimmer {
      position: relative; overflow: hidden; background: rgba(255,255,255,.06);
    }
    .shimmer::after {
      content: ""; position:absolute; inset:0; transform: translateX(-100%);
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.12), transparent);
      animation: shimmer 1.1s infinite;
    }
    @keyframes shimmer { 100% { transform: translateX(100%) } }

    .link { color: #a5b4fc; text-decoration: none }
    .link:hover { text-decoration: underline }

    /* --- RESPONSIVE STYLES --- */

    /* For tablets and smaller desktops */
    @media (max-width: 860px) {
      .grid { grid-template-columns: 1fr }
      header { flex-direction: column; align-items: stretch }
    }

    /* For mobile devices */
    @media (max-width: 520px) {
      .container {
        padding: 24px 12px 48px; /* MODIFIED: Reduced padding for more space */
      }
      .current {
        grid-template-columns: 1fr; /* Stack main weather and AQI card */
      }
      .details {
        grid-template-columns: 1fr; /* NEW: Stack all stat cards */
      }
      .aq {
        grid-template-columns: 1fr; /* NEW: Ensure AQI details stack cleanly */
      }
      .search {
        flex-direction: column; /* NEW: Stack search input and buttons for easier use */
      }
    }
  </style>
</head>
<body>
  <div class="aurora" aria-hidden="true"></div>

  <div class="container">
    <header>
      <div class="brand">
        <div class="logo"><span>WX</span></div>
        <div>
          <div class="title">Weather ‚Äî Sleek & Simple</div>
          <div class="subtitle">Powered by WeatherAPI ‚Ä¢ Live conditions & AQI</div>
        </div>
      </div>

      <form class="search" id="searchForm">
        <input id="city" type="text" placeholder="Search city, postcode, or 'lat,lon' (e.g., 28.61,77.21)" autocomplete="off" />
        <button type="button" id="geoBtn" class="btn" title="Use my location">üìç</button>
        <button type="submit" class="btn">Search</button>
      </form>
    </header>

    <main class="grid">
      <section class="card" id="currentCard">
        <div class="current" id="current">
          <div>
            <div class="place" id="place">‚Äî</div>
            <div class="time ghost" id="time">‚Äî</div>

            <div class="conditions">
              <img id="icon" alt="condition icon" class="ghost" />
              <div>
                <div class="temp" id="temp">‚Äî</div>
                <div class="unit-toggle" role="tablist" aria-label="Temperature unit">
                  <button id="toC" class="active" type="button">¬∞C</button>
                  <button id="toF" type="button">¬∞F</button>
                </div>
              </div>
            </div>

            <div class="row">
              <span class="badge" id="condition">‚Äî</span>
              <span class="chip" id="feels">Feels like ‚Äî</span>
              <span class="chip" id="wind">Wind ‚Äî</span>
              <span class="chip" id="humidity">Humidity ‚Äî</span>
              <span class="chip" id="pressure">Pressure ‚Äî</span>
            </div>

            <div class="details">
              <div class="stat"><div class="k">UV Index</div><div class="v" id="uv">‚Äî</div></div>
              <div class="stat"><div class="k">Visibility</div><div class="v" id="vis">‚Äî</div></div>
              <div class="stat"><div class="k">Cloud</div><div class="v" id="cloud">‚Äî</div></div>
              <div class="stat"><div class="k">Gust</div><div class="v" id="gust">‚Äî</div></div>
            </div>
          </div>

          <div class="card" style="background:rgba(255,255,255,.05); border:1px dashed rgba(255,255,255,.12);">
            <div style="display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px">
              <div style="font-weight:800; font-size:18px">Air Quality</div>
              <div id="aqBadge" class="badge">‚Äî</div>
            </div>
            <div class="aq">
              <div>
                <div class="k">US EPA Index</div>
                <div class="index" id="aqIndex">‚Äî</div>
                <div class="time" id="aqHint">‚Äî</div>
              </div>
              <div class="details" style="margin-top:0">
                <div class="stat"><div class="k">PM2.5</div><div class="v" id="pm25">‚Äî</div></div>
                <div class="stat"><div class="k">PM10</div><div class="v" id="pm10">‚Äî</div></div>
                <div class="stat"><div class="k">O‚ÇÉ</div><div class="v" id="o3">‚Äî</div></div>
                <div class="stat"><div class="k">NO‚ÇÇ</div><div class="v" id="no2">‚Äî</div></div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <aside class="card">
        <h3 style="margin: 6px 0 12px; font-size:18px">Quick picks</h3>
        <div class="row">
          <button class="btn" data-quick="London">London</button>
          <button class="btn" data-quick="Delhi">Delhi</button>
          <button class="btn" data-quick="New York">New York</button>
          <button class="btn" data-quick="Tokyo">Tokyo</button>
          <button class="btn" data-quick="Sydney">Sydney</button>
        </div>
        <p class="footer" style="margin-top:16px">Tip: Click üìç to use your current location.
          <br/>Built with <a class="link" href="https://www.weatherapi.com/" target="_blank" rel="noreferrer noopener">WeatherAPI</a>.
        </p>
      </aside>
    </main>

    <p class="footer">Sample API call (London):
      <code>http://api.weatherapi.com/v1/current.json?key=d56df21ff9684b4395f202905252908&q=London&aqi=yes</code>
    </p>
  </div>

  <script>
    const API_BASE = 'http://api.weatherapi.com/v1/current.json';
    const API_KEY = 'd56df21ff9684b4395f202905252908';

    const cityInput = document.getElementById('city');
    const searchForm = document.getElementById('searchForm');
    const geoBtn = document.getElementById('geoBtn');

    const dom = {
      place: document.getElementById('place'),
      time: document.getElementById('time'),
      icon: document.getElementById('icon'),
      temp: document.getElementById('temp'),
      condition: document.getElementById('condition'),
      feels: document.getElementById('feels'),
      wind: document.getElementById('wind'),
      humidity: document.getElementById('humidity'),
      pressure: document.getElementById('pressure'),
      uv: document.getElementById('uv'),
      vis: document.getElementById('vis'),
      cloud: document.getElementById('cloud'),
      gust: document.getElementById('gust'),
      aqIndex: document.getElementById('aqIndex'),
      aqBadge: document.getElementById('aqBadge'),
      aqHint: document.getElementById('aqHint'),
      pm25: document.getElementById('pm25'),
      pm10: document.getElementById('pm10'),
      o3: document.getElementById('o3'),
      no2: document.getElementById('no2'),
      toC: document.getElementById('toC'),
      toF: document.getElementById('toF'),
    };

    let latestData = null; // cache last response
    let useC = true;

    function setUnitButtons() {
      dom.toC.classList.toggle('active', useC);
      dom.toF.classList.toggle('active', !useC);
      if (latestData) updateTemps(latestData);
    }

    dom.toC.addEventListener('click', () => { useC = true; setUnitButtons(); });
    dom.toF.addEventListener('click', () => { useC = false; setUnitButtons(); });

    function fmt(n, unit='') { return `${n}${unit}`; }

    function aqiLabel(idx) {
      const map = { 1:'Good', 2:'Moderate', 3:'Unhealthy for SG', 4:'Unhealthy', 5:'Very Unhealthy', 6:'Hazardous' };
      return map[idx] || 'Unknown';
    }

    async function fetchWeather(q) {
      const url = `${API_BASE}?key=${API_KEY}&q=${encodeURIComponent(q)}&aqi=yes`;
      showLoading();
      try {
        const res = await fetch(url);
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();
        latestData = data;
        paint(data);
      } catch (err) {
        showError(err);
      }
    }

    function showLoading() {
      [dom.temp, dom.place, dom.time].forEach(el => { el.classList.add('shimmer'); el.textContent = ' '; });
      dom.icon.classList.add('shimmer');
    }

    function showError(err) {
      const msg = (err && err.message) ? err.message : 'Something went wrong';
      dom.place.textContent = 'Error fetching weather';
      dom.time.textContent = msg;
      dom.temp.textContent = '‚Äî';
      dom.icon.removeAttribute('src');
      [dom.temp, dom.place, dom.time, dom.icon].forEach(el => el.classList.remove('shimmer'));
    }

    function updateTemps(data) {
      const c = Math.round(data.current.temp_c);
      const f = Math.round(data.current.temp_f);
      const feels_c = Math.round(data.current.feelslike_c);
      const feels_f = Math.round(data.current.feelslike_f);
      dom.temp.textContent = useC ? `${c}¬∞` : `${f}¬∞`;
      dom.feels.textContent = `Feels like ${useC ? feels_c + '¬∞C' : feels_f + '¬∞F'}`;
    }

    function paint(data) {
      // remove shimmers
      [dom.temp, dom.place, dom.time, dom.icon].forEach(el => el.classList.remove('shimmer'));

      dom.place.textContent = `${data.location.name}, ${data.location.region || data.location.country}`;
      dom.time.textContent = `Local time: ${data.location.localtime}`;

      dom.icon.src = `https:${data.current.condition.icon}`;
      dom.icon.classList.remove('ghost');

      updateTemps(data);

      dom.condition.textContent = data.current.condition.text;
      dom.wind.textContent = `Wind ${Math.round(data.current.wind_kph)} km/h ${data.current.wind_dir}`;
      dom.humidity.textContent = `Humidity ${data.current.humidity}%`;
      dom.pressure.textContent = `Pressure ${data.current.pressure_mb} mb`;
      dom.uv.textContent = data.current.uv;
      dom.vis.textContent = `${data.current.vis_km} km`;
      dom.cloud.textContent = `${data.current.cloud}%`;
      dom.gust.textContent = `${data.current.gust_kph} km/h`;

      const aq = data.current.air_quality || {};
      const epa = Number(aq['us-epa-index']) || 0;
      dom.aqIndex.textContent = epa || '‚Äî';
      dom.aqBadge.textContent = aqiLabel(epa);
      dom.aqBadge.style.background = epa <= 2 ? 'rgba(52,211,153,.18)' : epa <= 3 ? 'rgba(245,158,11,.18)' : 'rgba(251,113,133,.18)';
      dom.aqBadge.style.borderColor = epa <= 2 ? 'rgba(52,211,153,.45)' : epa <= 3 ? 'rgba(245,158,11,.45)' : 'rgba(251,113,133,.45)';

      const n = (x) => x !== undefined ? Number(x).toFixed(1) : '‚Äî';
      dom.pm25.textContent = `${n(aq.pm2_5)} ¬µg/m¬≥`;
      dom.pm10.textContent = `${n(aq.pm10)} ¬µg/m¬≥`;
      dom.o3.textContent = `${n(aq.o3)} ¬µg/m¬≥`;
      dom.no2.textContent = `${n(aq.no2)} ¬µg/m¬≥`;

      dom.aqHint.textContent = epa ? `Air quality is ${aqiLabel(epa)}.` : '‚Äî';
    }

    // Search handlers
    searchForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const q = cityInput.value.trim();
      if (!q) return;
      fetchWeather(q);
    });

    // Quick pick buttons
    document.querySelectorAll('[data-quick]').forEach(btn => btn.addEventListener('click', () => {
      const q = btn.getAttribute('data-quick');
      cityInput.value = q;
      fetchWeather(q);
    }));

    // Geolocation
    geoBtn.addEventListener('click', () => {
      if (!navigator.geolocation) return alert('Geolocation not supported on this device.');
      navigator.geolocation.getCurrentPosition((pos) => {
        const q = `${pos.coords.latitude.toFixed(4)},${pos.coords.longitude.toFixed(4)}`;
        cityInput.value = q;
        fetchWeather(q);
      }, (err) => {
        alert('Could not get location: ' + err.message);
      }, { enableHighAccuracy: true, timeout: 10000, maximumAge: 30000 });
    });

    // Initial load: London per your sample API call
    window.addEventListener('DOMContentLoaded', () => {
      cityInput.value = 'London';
      fetchWeather('London');
      setUnitButtons();
    });
  </script>
</body>
</html>